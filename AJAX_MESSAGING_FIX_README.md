# ุฅุตูุงุญ ูุดููุฉ AJAX ูู ูุธุงู ุงูุฑุณุงุฆู - Endak

## ๐ฏ ุงููุดููุฉ
ูุงูุช ุงูุฑุณุงุฆู ุชูุฑุณู ุจูุฌุงุญ ูููู ุจุฏูุงู ูู ุฃู ุชุธูุฑ ูู ุงููุญุงุฏุซุฉุ ูุงู ูุธูุฑ JSON response ูููุณุชุฎุฏู.

## ๐ ุณุจุจ ุงููุดููุฉ
ุงูู form submission ูุงู ูุชู ุจุดูู ุนุงุฏู (normal form submission) ุจุฏูุงู ูู AJAXุ ููุง ูุคุฏู ุฅูู:
1. ุฅุฑุณุงู ุงูุจูุงูุงุช ููุฎุงุฏู โ
2. ุงุณุชูุจุงู JSON response โ
3. ุนุฑุถ JSON ุจุฏูุงู ูู ุฅุถุงูุฉ ุงูุฑุณุงูุฉ ูููุญุงุฏุซุฉ โ

## ๐๏ธ ุงูุญู ุงููุทุจู

### 1. **ุชุนุฏูู JavaScript ูู `messages/show.blade.php`**

#### ูุจู ุงูุฅุตูุงุญ:
```javascript
messageForm.addEventListener('submit', function(e) {
    console.log('Form submitted');
    const hasText = messageInput && messageInput.value.trim() !== '';
    const hasVoice = voiceNoteInput && voiceNoteInput.value !== '';
    const hasImage = imageInput && imageInput.files.length > 0;

    if (!hasText && !hasVoice && !hasImage) {
        e.preventDefault();
        alert('ูุฑุฌู ุฅุถุงูุฉ ุฑุณุงูุฉ ุฃู ุชุณุฌูู ุตูุชู ุฃู ุตูุฑุฉ ูุจู ุงูุฅุฑุณุงู.');
        return;
    }

    console.log('Form submission allowed');
});
```

#### ุจุนุฏ ุงูุฅุตูุงุญ:
```javascript
messageForm.addEventListener('submit', function(e) {
    e.preventDefault(); // ููุน ุงูุฅุฑุณุงู ุงูุนุงุฏู
    console.log('Form submitted');
    
    const hasText = messageInput && messageInput.value.trim() !== '';
    const hasVoice = voiceNoteInput && voiceNoteInput.value !== '';
    const hasImage = imageInput && imageInput.files.length > 0;

    if (!hasText && !hasVoice && !hasImage) {
        alert('ูุฑุฌู ุฅุถุงูุฉ ุฑุณุงูุฉ ุฃู ุชุณุฌูู ุตูุชู ุฃู ุตูุฑุฉ ูุจู ุงูุฅุฑุณุงู.');
        return;
    }

    console.log('Form submission allowed');
    
    // ุฅูุดุงุก FormData
    const formData = new FormData(messageForm);
    
    // ุฅุฑุณุงู ุทูุจ AJAX
    fetch(messageForm.action, {
        method: 'POST',
        body: formData,
        headers: {
            'X-CSRF-TOKEN': '{{ csrf_token() }}',
            'Accept': 'application/json'
        }
    })
    .then(response => response.json())
    .then(data => {
        console.log('Response:', data);
        
        if (data.success) {
            // ุฅุถุงูุฉ ุงูุฑุณุงูุฉ ุงูุฌุฏูุฏุฉ ูููุญุงุฏุซุฉ
            const chatContent = document.querySelector('.chat-content');
            if (chatContent && data.html) {
                chatContent.insertAdjacentHTML('beforeend', data.html);
                
                // ุงูุชูุฑูุฑ ููุฃุณูู
                chatContent.scrollTop = chatContent.scrollHeight;
                
                // ูุณุญ ุงููููุฐุฌ
                if (messageInput) messageInput.value = '';
                if (voiceNoteInput) voiceNoteInput.value = '';
                if (imageInput) imageInput.value = '';
                if (voicePlayback) voicePlayback.style.display = 'none';
                if (imagePreview) imagePreview.style.display = 'none';
                
                // ุฅุนุงุฏุฉ ุชุนููู ุนูุงุตุฑ ุงูุชุณุฌูู ุงูุตูุชู
                if (voiceControls) voiceControls.style.display = 'none';
                if (startVoiceBtn) startVoiceBtn.style.display = 'inline-block';
                if (stopVoiceBtn) stopVoiceBtn.style.display = 'none';
                if (voiceTimer) voiceTimer.textContent = '00:00';
                
                // ุชุญุฏูุซ ุญุงูุฉ ุฒุฑ ุงูุฅุฑุณุงู
                updateSendButtonState();
            }
        } else {
            alert('ูุดู ูู ุฅุฑุณุงู ุงูุฑุณุงูุฉ: ' + (data.message || 'ุฎุทุฃ ุบูุฑ ูุนุฑูู'));
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฅุฑุณุงู ุงูุฑุณุงูุฉ');
    });
});
```

## โ ุงููุชูุฌุฉ

### ูุจู ุงูุฅุตูุงุญ:
1. ุงููุณุชุฎุฏู ููุชุจ ุฑุณุงูุฉ
2. ูุถุบุท ุนูู ุฒุฑ ุงูุฅุฑุณุงู
3. ูุธูุฑ JSON response ุจุฏูุงู ูู ุงูุฑุณุงูุฉ ูู ุงููุญุงุฏุซุฉ
4. ุงููุณุชุฎุฏู ูุง ูุฑู ุงูุฑุณุงูุฉ ูู ุงููุญุงุฏุซุฉ

### ุจุนุฏ ุงูุฅุตูุงุญ:
1. ุงููุณุชุฎุฏู ููุชุจ ุฑุณุงูุฉ
2. ูุถุบุท ุนูู ุฒุฑ ุงูุฅุฑุณุงู
3. ูุชู ุฅุฑุณุงู ุงูุจูุงูุงุช ุนุจุฑ AJAX
4. ูุชู ุงุณุชูุจุงู JSON response
5. ูุชู ุฅุถุงูุฉ HTML ุงูุฑุณุงูุฉ ูููุญุงุฏุซุฉ
6. ูุชู ูุณุญ ุงููููุฐุฌ ูุฅุนุงุฏุฉ ุชุนููู ุงูุนูุงุตุฑ
7. ูุชู ุงูุชูุฑูุฑ ููุฃุณูู ุชููุงุฆูุงู
8. ุงููุณุชุฎุฏู ูุฑู ุงูุฑุณุงูุฉ ูู ุงููุญุงุฏุซุฉ ููุฑุงู โ

## ๐จ ุงููููุฒุงุช ุงููุถุงูุฉ

### 1. **ุงูุชุญุฏูุซ ุงููุจุงุดุฑ**
- ุงูุฑุณุงุฆู ุชุธูุฑ ููุฑุงู ุจุฏูู ุชุญุฏูุซ ุงูุตูุญุฉ
- ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุณูุณุฉ ูุณุฑูุนุฉ

### 2. **ูุณุญ ุงููููุฐุฌ ุงูุชููุงุฆู**
- ูุณุญ ุญูู ุงููุต
- ูุณุญ ุงูุชุณุฌูู ุงูุตูุชู
- ูุณุญ ุงูุตูุฑ ุงููุฑููุนุฉ
- ุฅุนุงุฏุฉ ุชุนููู ุนูุงุตุฑ ุงูุชุณุฌูู

### 3. **ุงูุชูุฑูุฑ ุงูุชููุงุฆู**
- ุงูุชูุฑูุฑ ููุฃุณูู ุชููุงุฆูุงู ุนูุฏ ุฅุฑุณุงู ุฑุณุงูุฉ ุฌุฏูุฏุฉ
- ุงููุณุชุฎุฏู ูุฑู ุงูุฑุณุงูุฉ ุงูุฌุฏูุฏุฉ ููุฑุงู

### 4. **ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก**
- ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ูููุณุชุฎุฏู
- ูุนุงูุฌุฉ ุฃุฎุทุงุก ุงูุดุจูุฉ
- ูุนุงูุฌุฉ ุฃุฎุทุงุก ุงูุฎุงุฏู

### 5. **ุชุญุฏูุซ ุญุงูุฉ ุงูุนูุงุตุฑ**
- ุชุญุฏูุซ ุญุงูุฉ ุฒุฑ ุงูุฅุฑุณุงู
- ุฅุนุงุฏุฉ ุชุนููู ุนูุงุตุฑ ุงูุชุณุฌูู ุงูุตูุชู
- ุฅุฎูุงุก ูุนุงููุฉ ุงูุตูุฑ

## ๐ง ุงููููุงุช ุงููุนุฏูุฉ

### `resources/views/messages/show.blade.php`
- ุฅุถุงูุฉ `e.preventDefault()` ูููุน ุงูุฅุฑุณุงู ุงูุนุงุฏู
- ุฅุถุงูุฉ AJAX submission
- ุฅุถุงูุฉ ูุนุงูุฌุฉ ุงูู response
- ุฅุถุงูุฉ ุฅุฏุฑุงุฌ HTML ุงูุฑุณุงูุฉ
- ุฅุถุงูุฉ ูุณุญ ุงููููุฐุฌ
- ุฅุถุงูุฉ ุงูุชูุฑูุฑ ุงูุชููุงุฆู

## ๐ ุงููุธุงู ุงูุขู ูุนูู ุจุดูู ูุซุงูู!

### ุงููุธุงุฆู ุงููุชุงุญุฉ:
- โ ุฅุฑุณุงู ุฑุณุงุฆู ูุตูุฉ
- โ ุฅุฑุณุงู ุฑุณุงุฆู ุตูุชูุฉ
- โ ุฑูุน ุงูุตูุฑ ูุงููููุงุช
- โ ุนุฑุถ ุงูุฑุณุงุฆู ููุฑุงู ูู ุงููุญุงุฏุซุฉ
- โ ูุณุญ ุงููููุฐุฌ ุชููุงุฆูุงู
- โ ุงูุชูุฑูุฑ ุงูุชููุงุฆู
- โ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก

### ุงูุฑูุงุจุท:
- **ุงูุฑุณุงุฆู ุงูุฌุฏูุฏุฉ**: `http://127.0.0.1:8000/messages/new`
- **ูุญุงุฏุซุฉ ูุน ูุณุชุฎุฏู**: `http://127.0.0.1:8000/messages/{userId}`

## ๐ ุงูุฎูุงุตุฉ

ุชู ุฅุตูุงุญ ูุดููุฉ AJAX ุจูุฌุงุญ! ุงูุขู:

1. **ุงูุฑุณุงุฆู ุชูุฑุณู ุนุจุฑ AJAX** โ
2. **ุชุธูุฑ ููุฑุงู ูู ุงููุญุงุฏุซุฉ** โ
3. **ุงููููุฐุฌ ูุชู ูุณุญู ุชููุงุฆูุงู** โ
4. **ุงูุชูุฑูุฑ ูุชู ุชููุงุฆูุงู** โ
5. **ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุณูุณุฉ** โ

**ุงููุธุงู ุงูุขู ูุนูู ุจุดูู ูุซุงูู! ๐**

---

**ุชู ุงูุฅุตูุงุญ ุจูุงุณุทุฉ ูุฑูู Endak**  
**ุชุงุฑูุฎ ุงูุฅุตูุงุญ**: 31 ุฃุบุณุทุณ 2025  
**ุงูุฅุตุฏุงุฑ**: 2.2.2
